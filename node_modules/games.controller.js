var debug = require('debug')('games.controller.js');

function Gamescontroller(){}

Gamescontroller.prototype.playersdata = {};

/*
    # создает связку между игроками, сохраняя сокеты противников
*/
Gamescontroller.prototype.addGame = function(player1 , player2){
    var p1 = ('id' in player1 && 'socket' in player1) ? player1 : false;
    var p2 = ('id' in player2 && 'socket' in player2) ? player2 : false;
    
    if(p1 && p2){
        
        this.playersdata[p1.id] =
                {
                    id          : p1.id ,
                    socket      : p1.socket ,
                    
                    enemyid     : p2.id ,
                    enemysocket : p2.socket
                };
                
        this.playersdata[p2.id] =
                {
                    id          : p2.id ,
                    socket      : p2.socket ,
                    
                    enemyid     : p1.id ,
                    enemysocket : p1.socket
                };
    }else{
        debug('ERROR. Переданы не все данные игроков');
    }
    
};

Gamescontroller.prototype.sendEnemyData = function(selfid , title , data){
    if(this.playersdata[selfid] !== undefined){
       this.playersdata[selfid].enemysocket.emit(title , data);
    }else{
        debug('ERROR. Не найден объект игрока, при отправке запроса ' , title);
    }
};

module.exports = Gamescontroller;